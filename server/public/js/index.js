"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var State=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"set",value:function(e,t){this[e]=t}},{key:"get",value:function(e){return this[e]}}]),e}(),state=new State,socket=io(),form=document.querySelector(".messageForm"),usernameForm=document.querySelector(".usernameForm");form&&(form.addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("message"),a=state.get("username"),n=state.get("id");t&&t.value&&0<t.value.length&&a&&(socket.emit("chat message",{message:t.value,user:a,id:n}),t.value="")}),socket.on("chat message",function(e){var t=e.user,a=e.id,n=e.message,r=state.get("username"),s=state.get("id");if(!r&&!s)throw new Error("No username found");var o=document.querySelector("#messages");if(o){var u=document.createElement("li"),i=document.createElement("span");i.classList.add("username"),i.innerText=t,u.innerText=n,u.classList.add(t+a===r+s?"self":"other"),u.classList.contains("self")&&(i.style="text-align: right;"),i.appendChild(u),o.appendChild(i)}})),usernameForm&&usernameForm.addEventListener("submit",function(e){e.preventDefault();var t=usernameForm.querySelector(".usernameInput");t&&t.value&&0<t.value.length&&(state.set("id",Math.floor(9999*Math.random())+1),state.set("username",t.value),usernameForm.style="display: none;")});